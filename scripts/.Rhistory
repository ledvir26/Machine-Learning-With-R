pred1 <- knn(train[,4:5], val[,4:5], train[,3], k = 4)
errmat1 <- table(val$Result, pred1, dnn = c("Actual", "Predichos"))
errmat1
pred1 <- knn(train[,4:5], val[,4:5], train[,3], k = 5)
errmat1 <- table(val$Result, pred1, dnn = c("Actual", "Predichos"))
errmat1
pred2 <- knn(train[,4:5], test[,4:5], train[,3], k = 1)
errmat2 <- table(test$Result, pred2, dnn = c("Actual", "Predichos"))
errmat2
pred2 <- knn(train[,4:5], test[,4:5], train[,3], k = 2)
errmat2 <- table(test$Result, pred2, dnn = c("Actual", "Predichos"))
pred2 <- knn(train[,4:5], test[,4:5], train[,3], k = 2)
errmat2 <- table(test$Result, pred2, dnn = c("Actual", "Predichos"))
errmat2
pred2 <- knn(train[,4:5], test[,4:5], train[,3], k = 3)
errmat2 <- table(test$Result, pred2, dnn = c("Actual", "Predichos"))
errmat2
pred2 <- knn(train[,4:5], test[,4:5], train[,3], k = 5)
pred2 <- knn(train[,4:5], test[,4:5], train[,3], k = 4)
errmat2 <- table(test$Result, pred2, dnn = c("Actual", "Predichos"))
errmat2
pred2 <- knn(train[,4:5], test[,4:5], train[,3], k = 6)
errmat2 <- table(test$Result, pred2, dnn = c("Actual", "Predichos"))
errmat2
print(tab)
cat("------------\n")
cat(paste("Matriz de confusión para k= ",k, "\n"))
cat("===============\n")
knn.automate(train[,4:5], val[,4:5], train[,3], val[,3], 1,8)
knn.automate <- function(tr_predictors, val_predictors, tr_target,
val_target, start_k, end_k){
for (k in start_k:end_k) {
pred <- knn(tr_predictors, val_predictors, tr_target, l)
tab <- table(val_target, pred, dnn = c("Actual", "Predichos"))
cat(paste("Matriz de confusión para k= ",k, "\n"))
cat("===============\n")
print(tab)
cat("------------\n")
}
}
knn.automate(train[,4:5], val[,4:5], train[,3], val[,3], 1,8)
pred <- knn(tr_predictors, val_predictors, tr_target, k)
cat("===============\n")
knn.automate <- function(tr_predictors, val_predictors, tr_target,
val_target, start_k, end_k){
for (k in start_k:end_k) {
pred <- knn(tr_predictors, val_predictors, tr_target, k)
tab <- table(val_target, pred, dnn = c("Actual", "Predichos"))
cat(paste("Matriz de confusión para k= ",k, "\n"))
cat("===============\n")
print(tab)
cat("------------\n")
}
knn.automate(train[,4:5], val[,4:5], train[,3], val[,3], 1,8)
knn.automate <- function(tr_predictors, val_predictors, tr_target,
val_target, start_k, end_k){
for (k in start_k:end_k) {
pred <- knn(tr_predictors, val_predictors, tr_target, k)
tab <- table(val_target, pred, dnn = c("Actual", "Predichos"))
cat(paste("Matriz de confusión para k= ",k, "\n"))
cat("===============\n")
print(tab)
cat("------------\n")
}
}
knn.automate(train[,4:5], val[,4:5], train[,3], val[,3], 1,8)
library(caret)
library(e1071)
banknote <- read.csv("../data/tema3/banknote-authentication.csv")
banknote$class = factor(banknote$class)
set.seed(2018)
t.ids <- createDataPartition(banknote$class, p = 0.7, list = F)
mod <- svm(class ~ ., data = banknote[t.ids, ] )
table(banknote[t.ids,"class"], fitted(mod), dnn = c("Actual","Predicho"))
pred <- predict(mod, banknote[-t.ids,])
table(banknote[-t.ids, "class"], pred, dnn = c("Actual","Predicho"))
plot(mod, data=banknote[t.ids,],skew ~variance)
tuned <- tune.svm(class ~., data = banknote[t.ids,],
gamma = 10^(-6:-1), cost = 10^(1:2))
library(class)
library(caret)
vac <- read.csv("../data/tema3/vacation-trip-classification.csv")
vac$Income.z <- scale(vac$Income)
vac$Family_size.z <- scale(vac$Family_size)
set.seed(2018)
t.ids <- createDataPartition(vac$Result, p = 0.5, list = F)
train <- vac[t.ids, ]
temp <- vac[-t.ids, ]
v.ids <- createDataPartition(temp$Result, p = 0.5, list = F)
val <- temp[v.ids,]
test <- temp[-v.ids, ]
pred1 <- knn(train[,4:5], val[,4:5], train[,3], k = 5)
errmat1 <- table(val$Result, pred1, dnn = c("Actual", "Predichos"))
errmat1
pred2 <- knn(train[,4:5], test[,4:5], train[,3], k = 6)
errmat2 <- table(test$Result, pred2, dnn = c("Actual", "Predichos"))
errmat2
knn.automate <- function(tr_predictors, val_predictors, tr_target,
val_target, start_k, end_k){
for (k in start_k:end_k) {
pred <- knn(tr_predictors, val_predictors, tr_target, k)
tab <- table(val_target, pred, dnn = c("Actual", "Predichos"))
cat(paste("Matriz de confusión para k= ",k, "\n"))
cat("===============\n")
print(tab)
cat("------------\n")
}
}
knn.automate(train[,4:5], val[,4:5], train[,3], val[,3], 1,8)
trcntrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)
caret_knn_fit <- train(Result ~ Family_size.z + Income, data=train,
method ="knn", trControl = trcontrol,
preProcess = c("center", "scale"),
tuneLength = 10)
trcntrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)
caret_knn_fit <- train(Result ~ Family_size.z + Income, data=train,
method ="knn", trControl = trcontrol,
preProcess = c("center", "scale"),
tuneLength = 10)
caret_knn_fit <- train(Result ~ Family_size.z + Income, data=train,
method ="knn", trControl = trcntrl,
preProcess = c("center", "scale"),
tuneLength = 10)
caret_knn_fit
pred5 <- knn(train[,4:5], val[,4:5], train[,3], k=5, prob=T)
pred5
install.packages("nnet")
install.packages("nnet")
install.packages("nnet")
install.packages("nnet")
install.packages("nnet")
install.packages("nnet")
library(nnet)
library(caret)
bn <- read.csv("../data/tema3/banknote-authentication.csv")
bn$class <- factor(bn$class)
t.id <- createDataPartition(bn$class, p = 0.7, list = F)
mod <- nnet(class ~ ., data = bn[t.id,],
size = 3, maxit = 10000, decay = 0.001, rang = 0.05)
mod <- nnet(class ~ ., data = bn[t.id,],
size = 3, maxit = 10000, decay = 0.001, rang = 0.05,
na.action = na.omit, skip = T)
# ranf * max(|variables|) ~ 1
apply(bn, 2, max)
pred <. predict(mod, newdata = bn[-t.id,], type = "raw")
pred <- predict(mod, newdata = bn[-t.id,], type = "raw")
perf <- perfo
perf <- performance(prediction(pred2, bn[-t.id, "class"]), "tpr","fpe")
library(ROCR)
pred <- predict(mod, newdata = bn[-t.id,], type = "raw")
perf <- performance(prediction(pred2, bn[-t.id, "class"]), "tpr","fpe")
perf <- performance(prediction(pred2, bn[-t.id, "class"]),
"tpr","fpr")
perf <- performance(prediction(pred2, bn[-t.id, "class"]),
"tpr","fpr")
t.id <- createDataPartition(bn$class, p = 0.7, list = F)
mod <- nnet(class ~ ., data = bn[t.id,],
size = 3, maxit = 10000, decay = 0.001, rang = 0.05,
na.action = na.omit, skip = T)
# ranf * max(|variables|) ~ 1
apply(bn, 2, max)
library(ROCR)
pred <- predict(mod, newdata = bn[-t.id,], type = "raw")
perf <- performance(prediction(pred2, bn[-t.id, "class"]),
"tpr","fpr")
pred2 <- predict(mod, newdata = bn[-t.id,], type = "raw")
perf <- performance(prediction(pred2, bn[-t.id,"class"]),
"tpr", "fpr")
pred2 <- predict(mod, newdata = bn[-t.id,], type = "raw")
perf <- performance(prediction(pred2, bn[-t.id,"class"]),
"tpr", "fpr")
plot(perf)
install.packages("MASS")
install.packages("MASS")
install.packages("MASS")
library(MASS)
library(caret)
bn <- read.csv("../data/tema3/banknote-authentication.csv")
bn$class <- factor(bn$class)
set.seed(2018)
t.id <- createDataPartition(bn$class, p = 0.7, list = F)
mod <- lda(bn[t.id, 1:4], bn[t.id,5])
bn[t.ids, "Pred"] <- predict(mod, bn[t.id, 1:4])$class
library(MASS)
library(caret)
bn <- read.csv("../data/tema3/banknote-authentication.csv")
bn$class <- factor(bn$class)
set.seed(2018)
t.id <- createDataPartition(bn$class, p = 0.7, list = F)
mod <- lda(bn[t.id, 1:4], bn[t.id,5])
bn[t.ids, "Pred"] <- predict(mod, bn[t.id, 1:4])$class
bn[t.ids, "Pred"] <- predict(mod, bn[t.id, 1:4])$class
bn <- read.csv("../data/tema3/banknote-authentication.csv")
bn$class <- factor(bn$class)
set.seed(2018)
t.id <- createDataPartition(bn$class, p = 0.7, list = F)
mod <- lda(bn[t.id, 1:4], bn[t.id,5])
bn[t.ids, "Pred"] <- predict(mod, bn[t.id, 1:4])$class
bn <- read.csv("../data/tema3/banknote-authentication.csv")
bn$class <- factor(bn$class)
set.seed(2018)
t.id <- createDataPartition(bn$class, p = 0.7, list = F)
mod <- lda(bn[t.id, 1:4], bn[t.id,5])
bn[t.ids, "Pred"] <- predict(mod, bn[t.id, 1:4])$class
mod <- lda(bn[t.id,1:4], bn[t.id,5])
bn[t.id, "Pred"] <- predict(mod, bn[t.id, 1:4])$class
bn[t.id, "Pred"] <- predict(mod, bn[t.id, 1:4])$class
table(bn[t.id, "class"], bn[t.id, "Pred"], dnn = c("Actual", "Predichos"))
bn[-t.id, "Pred"] <- predict(mod, bn[-t.id, 1:4])$class
table(bn[-t.id, "class"], bn[-t.id, "Pred"], dnn = c("Actual", "Predichos"))
View(bn)
library(caret)
bh <- read.csv("../data/tema3/boston-housing-logistic.csv")
bh <- read.csv("../data/tema3/boston-housing-logistic.csv")
View(bh)
bh$class <- factor(bh$CLASS, levels = c(0,1))
set.seed(2018)
t.id <- createDataPartition(bh$CLASS, p=0.7, list=F)
mod <- glm(CLASS ~ ., data = bh[t.id, ], family = binomial)
bh <- read.csv("../data/tema3/boston-housing-logistic.csv")
bh$CLASS <- factor(bh$CLASS, levels = c(0,1))
set.seed(2018)
t.id <- createDataPartition(bh$CLASS, p=0.7, list=F)
mod <- glm(CLASS ~ ., data = bh[t.id, ], family = binomial)
summary(mod)
bh[-t.id, "PROB_SUCCESS"] <- predict(mod, newdata = bh[-t.id,], type="response")
bh[-t.id, "PRED_50"] <- ifelse(bh[-t.id, "PROB_SUCCESS"]>=0.5, 1, 0)
table(bh[-t.id,"CLASS"], bh[-t.id,"PRED_50"], dnn=c("Actual","Predicho"))
library(caret)
library(rpart)
library(rpart.plot)
bank = read.csv("../../proyectos/data/bank.csv")
head(bank)
View(bank)
bank = read.csv("../../proyectos/data/bank.csv", sep = ";")
head(bank)
View(bank)
training.ids <- createDataPartition(bank$y, p = 0.7, list = F)
mod <- rpart(y ~ ., data = bank[training.ids,],
method = "class",
control = rpart.control(minsplit = 20, cp = 0.01))
mod
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray")
fancyRpartPlot(bank.cart , digits=2 , palettes = c("Purples", "Oranges"))
fancyRpartPlot(mod , digits=2 , palettes = c("Purples", "Oranges"))
fancyRpartPlot(mod , digits=2 , palettes = c("Purples", "Oranges"))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", palettes = c("Purples", "Oranges"))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", palettes = c("Purples", "Oranges"))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", palette = c("Purples", "Oranges"))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.col=ifelse(tree$frame$yval > 30, 'red', 'green'))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.col=ifelse(tree$frame$yval > 30, 'red', 'green'))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.col=ifelse(mod$frame$yval > 30, 'red', 'green'))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.col=c("green", "orange", "red")[findInterval(tree$frame$yval, v = c(0,20,30))])
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.col=c("green", "orange", "red")[findInterval(mod$frame$yval, v = c(0,20,30))])
mod <- rpart(y ~ ., data = bank[training.ids,],
method = "class",
control = rpart.control(minsplit = 20, cp = 0.01))
mod
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.col=c("green", "orange", "red")[findInterval(mod$frame$yval, v = c(0,20,30))])
prp(mod, extra=1, faclen=0,  nn=T, box.palette=c("green", "red"))
# examples using built-in palettes
prp(mod, extra=1, faclen=0,  nn=T, box.palette="GnRd")
prp(mod, extra=1, faclen=0,  nn=T, box.palette="Blues")
prp(mod, extra=1, faclen=0,  nn=T, box.palette=c("green", "red"))
# examples using built-in palettes
prp(mod, extra=1, faclen=0,  nn=T, box.palette="GnRd")
mod <- rpart(y ~ ., data = bank[training.ids,],
method = "class",
control = rpart.control(minsplit = 20, cp = 0.01))
mod
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.palette=c("green", "red"))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.palette=c("Purples", "oranges"))
prp(mod, type = 2, extra = 104, nn = TRUE,
fallen.leaves = TRUE, faclen = 4, varlen = 8,
shadow.col = "gray", box.palette=c("purples", "oranges"))
par(mfrow=c(1,1))
fancyRpartPlot(mod , digits=2 , palettes = c("Purples", "Oranges"))
library(ggplot2)
fancyRpartPlot(mod , digits=2 , palettes = c("Purples", "Oranges"))
library(rattle)
fancyRpartPlot(mod , digits=2 , palettes = c("Purples", "Oranges"))
#predict
cart_pred <- predict( mod , testdata , type = "class")
cart_prob <- predict( mod , testdata , type = "prob")
mod$cptable
0.8924051 +0.05079464
0.05188265+0.8924051
mod.pruned <- prune(mod, mod$cptable[4, "CP"])
prp(mod.pruned, type = 2, extra = 104, nn = TRUE,
fallen.leaves =  TRUE, faclen = 4 , varlen = 8,
shadow.col = "gray")
mod.pruned <- prune(mod, mod$cptable[5, "CP"])
prp(mod.pruned, type = 2, extra = 104, nn = TRUE,
fallen.leaves =  TRUE, faclen = 4 , varlen = 8,
shadow.col = "gray")
mod.pruned <- prune(mod, mod$cptable[4, "CP"])
prp(mod.pruned, type = 2, extra = 104, nn = TRUE,
fallen.leaves =  TRUE, faclen = 4 , varlen = 8,
shadow.col = "gray")
fancyRpartPlot(mod.pruned , digits=2 , palettes = c("Purples", "Oranges"))
prp(mod.pruned, type = 2, extra = 104, nn = TRUE,
fallen.leaves =  TRUE, faclen = 4 , varlen = 8,
shadow.col = "gray")
fancyRpartPlot(mod.pruned , digits=2 , palettes = c("Purples", "Oranges"))
pred.pruned <- predict(mod.pruned, bank[-training.ids,], type="class")
table(banknote[-training.ids,]$class, pred.pruned,
dnn = c("Actual", "Predicho"))
table(bank[-training.ids,]$class, pred.pruned,
dnn = c("Actual", "Predicho"))
table(bank[-training.ids,]$y, pred.pruned,
dnn = c("Actual", "Predicho"))
table(bank[-training.ids,]$y, pred.pruned,
dnn = c("Actual", "Predicho"), type="prob")
table(bank[-training.ids,]$y, mod.pruned,
dnn = c("Actual", "Predicho"))
table(bank[-training.ids,]$y, mod.pruned,
dnn = c("Actual", "Predicho"))
pred
table(bank[-training.ids,]$y, pred.pruned,
dnn = c("Actual", "Predicho"))
pred.pruned <- predict(mod.pruned, bank[-training.ids,], type="prob")
table(bank[-training.ids,]$y, pred.pruned,
dnn = c("Actual", "Predicho"))
table(bank[-training.ids,]$y, pred.pruned,
dnn = c("Actual", "Predicho"))
pred.pruned <- predict(mod.pruned, bank[-training.ids,], type="class")
table(bank[-training.ids,]$y, pred.pruned,
dnn = c("Actual", "Predicho"))
pred.pruned1 <- predict(mod.pruned, bank[-training.ids,], type="prob")
table(bank[-training.ids,]$y, pred.pruned,pred.pruned1,
dnn = c("Actual", "Predicho"))
table(bank[-training.ids,]$y, pred.pruned,
dnn = c("Actual", "Predicho"))
table(bank[-training.ids,]$y, pred.pruned1,
dnn = c("Actual", "Predicho"))
table(bank[-training.ids,]$y, pred.pruned,
dnn = c("Actual", "Predicho"))
t.ids <- createDataPartition(bank$Y, p = 0.7, list = F)
bank = read.csv("../../proyectos/data/bank.csv", sep = ";")
t.ids <- createDataPartition(bank$Y, p = 0.7, list = F)
mod <- svm(Y ~ ., data = bank[training.ids, ] )
library(e1071)
mod <- svm(Y ~ ., data = bank[training.ids, ] )
mod <- svm(y ~ ., data = bank[training.ids, ] )
mod <- svm(y ~ ., data = bank[training.ids, ] )
library(class)
library(caret)
bank = read.csv("../../proyectos/scripts/analisis bank.R", sep = ";")
bank = read.csv("../../proyectos/scripts/analisis bank.R", sep = ";")
bank = read.csv("../../proyectos/data/bank.csv", sep = ";")
t.ids <- createDataPartition(vac$Result, p = 0.5, list = F)
t.ids <- createDataPartition(bank$y, p = 0.5, list = F)
train <- bank[t.ids, ]
temp <- bank[-t.ids, ]
v.ids <- createDataPartition(bank$y, p = 0.5, list = F)
val <- temp[v.ids,]
test <- temp[-v.ids, ]
pred1 <- knn(train[,4:5], val[,4:5], train[,3], k = 5)
errmat1 <- table(bank$y, pred1, dnn = c("Actual", "Predichos"))
pred1 <- knn(train[,4:5], val[,4:5], train[,3], k = 5)
errmat1 <- table(bank$y, pred1, dnn = c("Actual", "Predichos"))
pred1 <- knn(train[,4:5], val[,4:5], train[,3], k = 5)
pred1 <- knn(train[,4:5], val[,4:5], train[,3], k = 5)
pred1 <- knn(train[,20:21], val[,20:21], train[,3], k = 5)
pred1 <- knn(train[,20:21], val[,20:21], train[,20], k = 5)
errmat1 <- table(bank$y, pred1, dnn = c("Actual", "Predichos"))
errmat1
pred1 <- knn(train[,20:21], val[,20:21], train[,20], k = 5)
pred1 <- knn(train[,21:22], val[,21:22], train[,21], k = 5)
pred1 <- knn(train[,20:21], val[,20:21], train[,21], k = 5)
pred1 <- knn(train[,20:21], val[,20:21], train[,21], k = 5)
pred1 <- knn(train[,21], val[,21], train[,21], k = 5)
pred1 <- knn(train[,20:21], val[,20:21], train[,21], k = 5)
errmat1 <- table(bank$y, pred1, dnn = c("Actual", "Predichos"))
pred1 <- knn(train[,20:21], val[,20:21], train[,21], k = 5)
bank.knn <- train(y ~ ., data = traindata, method = "knn",
maximize = TRUE,
trControl = trainControl(method = "cv", number = 10),
preProcess=c("center", "scale"))
bank.knn <- train(y ~ ., data = bank, method = "knn",
maximize = TRUE,
trControl = trainControl(method = "cv", number = 10),
preProcess=c("center", "scale"))
summary(tuned)
summary(mod)
edu <- read.csv("../data/tema4/education.csv")
dms <- dummy(edu$region, sep = '_')
edu <- cbind(edu, dms)
edu$urban.s <- rescale(edu$urban)
edu$income.s <- rescale(edu$income)
edu$under18.s <- rescale(edu$under18)
set.seed(2018)
library(dummies)
library(FNN)
library(scales)
library(caret)
edu <- read.csv("../data/tema4/education.csv")
dms <- dummy(edu$region, sep = '_')
edu <- cbind(edu, dms)
edu$urban.s <- rescale(edu$urban)
edu$income.s <- rescale(edu$income)
edu$under18.s <- rescale(edu$under18)
set.seed(2018)
t.id <- createDataPartition(edu$expense, p=0.6, list = FALSE)
tr <- edu[t.id, ]
temp <- edu[-t.id, ]
v.id <- createDataPartition(temp$expense, p=0.5, list=F)
val <- temp[v.id,]
test <- temp[-v.id,]
reg1 <- knn.reg(tr[,7:12], val[,7:12], tr$expense, k=1,
algorithm = "brute")
rmse1 <- sqrt(mean((reg1$pred-val$expense)^2))
rmse1
View(edu)
edu <- read.csv("../data/tema4/education.csv")
dms <- dummy(edu$region, sep = "_")
edu <- cbind(edu, dms)
edu$urban.s <- rescale(edu$urban)
edu$income.s <- rescale(edu$income)
edu$under18.s <- rescale(edu$under18)
set.seed(2018)
t.id <- createDataPartition(edu$expense, p=0.6, list = F)
tr <- edu[t.id, ]
temp <- edu[-t.id, ]
v.id <- createDataPartition(temp$expense, p=0.5, list = F)
val <- temp[v.id,]
test <- temp[-v.id,]
reg1 <- knn.reg(tr[,7:12], val[,7:12], tr$expense, k=1,
algorithm = "brute")
rmse1 <- sqrt(mean((reg1$pred-val$expense)^2))
rmse1
reg2 <- knn.reg(tr[,7:12], val[,7:12], tr$expense, k=2,
algorithm = "brute")
rmse2 <- rmse(val$expense, reg2$pred)
rmse2
reg3 <- knn.reg(tr[,7:12], val[,7:12], tr$expense, k=3,
algorithm = "brute")
rmse3 <- rmse(val$expense, reg3$pred)
rmse3
df = data.frame(actual = val$expense, pred = reg3$pred)
plot(df)
View(dms)
View(temp)
library(caret)
auto <- read.csv("../data/tema4/auto-mpg.csv")
auto$cylinders <<- factor(auto$cylinders,
levels = c(3,4,5,6,8),
labels = c("3c", "4c", "5c", "6c","8c"))
auto$cylinders <- factor(auto$cylinders,
levels = c(3,4,5,6,8),
labels = c("3c", "4c", "5c", "6c","8c"))
set.seed(2018)
t.id <- createDataPartition(auto$mpg, p=0.7, list=F)
nmaes(auto)
names(auto)
View(auto)
mod<- lm(mpg ~ ., data = auto[t.id, -c (1,8,9)])
mod
summary(mod)
boxplot(mod$residuals)
View(mod)
pred <- predict(mod, auto[-t.id, -c(1,8,9)])
par(mfrow=c(2,2))
plot(mod)
100/239
105/239
107/239
108/239
auto <- within(auto,
cylinders = relevel(cylinders, ref="4c"))
auto <- within(auto,
cylinders = relevel(cylinders, ref="4c"))
auto <- within(auto,
cylinders <- relevel(cylinders, ref="4c"))
mod <- lm(mpg ~. , data = auto[-t.id, -c(1,8,9)])
mod
pred <- predict(mod, auto[-t.id, -c(1,8,9)])
plot(mod)
library(MASS)
mod
summary(mod)
step.model <- stepAIC(mod, direction = "forward")
summary(step.model)
step.model <- stepAIC(mod, direction = "backward")
summary(step.model)
step.model <- stepAIC(mod, direction = "backward")
summary(step.model)
install.packages("rpart")
